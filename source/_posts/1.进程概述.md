---
title: 进程概述
categories: [linux,进程]
data: 2023-01-12 03:00:28
---

## 进程概述

从严格意义上来说，程序不同于进程，它们的状态和占用的系统资源都是不同的；

- 程序是指磁盘上的可执行文件，并且只占用磁盘上的空间，是一个静态的概念
- 进程是指正在执行的程序，不占用磁盘空间，但需要消耗系统的内存和CPU资源，每个运行的进程都对应一个独立的虚拟地址空间，是一个动态的概念

## 并行和并发

### CPU时间片

CPU在投个时间只能处理一个任务，但是操作系统是支持多任务的，那么在计算机CPU只有一个的情况下是如何完成多任务处理的呢？CPU会给每个进程分配一小段时间，这段时间对于进程来说就叫做时间片，进程拥有时间片时才允许运行，因为时间片通常来说非常短暂，所以从表面上看各个进程都是同时运行的，这就是分时复用的思想；如果时间片结束进程还在运行，CPU会中断这个进程并且挂起等待下一个时间片。如果进程在时间片结束前阻塞或者结束，那么CPU的使用权会被释放，让给其他需要运行的进程，这样可以避免CPU资源的浪费；因此计算机中多个程序从宏观上看是同时运行的，从微观上看由于CPU一次只能处理一个进程，所以他们是轮流执行的，只不过切换的速度非常快；且CPU的核数越多，计算机的处理效率越高

### 并发和并行

并发和并行都可以理解为多个进程同时运行，但是它们又有所不同

- 并发的同时运行是指由于CPU的时间片切换速度非常快，进程看上去是在同时运行，但实际上还是轮流执行；并发这个概念是针对某一个硬件资源而言的，在某个时间段内处理任务的总量越大，我们就可以说并发效率越高
- 并行的同时运行是指多个硬件资源同时运行多个任务，是真真切切的同时运行；并行需要依赖多个硬件资源，单个硬件资源没有并行的概念

## PCB

PCB是指进程控制块，linux内核的进程控制块本质上一个叫做task_struct的结构体，在这个结构体中记录了进程运行相关的一些信息：

- 进程ID：每一个进程都对应着一个唯一的进程ID，类型为pid_t，是一个整型数
- 进程的状态：进程有不同的状态，状态时一直在变化的，有就绪态、运行态、挂起和停止等状态
- 进程对应的虚拟地址空间的信息
- 描述控制终端的信息，进程在哪个终端启动就默认和哪个终端进行绑定
- 当前工作目录：默认情况下，启动进程的目录就是当前的工作目录
- umask掩码：在创建新文件的时候，通过这个掩码屏蔽某些用于对文件的操作权限
- 文件描述符：每个被分配的文件描述符都对应一个已经打开的磁盘文件
- 和信号相关的信息：在linux中调用函数，键盘快捷键，执行shell命令等操作都会产生信号
- 阻塞信号集：记录当前进程中阻塞哪些已产生的信号，使其不能被处理
- 未决信号集：记录在当前进程中产生的哪些信号还没有被处理掉
- 用户ID和用户组ID：当前进程属于哪个用户和哪个用户组
- 会话和进程组：多个进程的集合叫做进程组，多个进程组的集合叫做会话
- 进程可以使用的资源上限：可以使用shell命令ulimit -a查看

## 进程状态

进程一共有五种状态分别为：创建态，就绪态，运行态，阻塞态（挂起态），退出态（终止态）；其中创建态和退出态维持的时间是非常短的，我们将就绪态，运行态，挂起态三者之间的切换理解清楚

-  就绪态：进程被创建出来，有运行的资格但是还没有运行，需要去抢占CPU的时间片，得到时间片之后进程开始运行，从就绪态转换为运行态，当时间片用完以后，进程失去CPU的使用权，又从运行态转换为就绪态
- 运行态：运行态不会一直持续，进程的时间片运行完失去CPU后，就会从运行态转换为就绪态，只要进程没有退出就会一直在就绪态和运行态之间不停的切换
- 阻塞态：进程被强制放弃CPU并且没有抢夺CPU时间片的资格，比如在程序中调用了sleep函数等，进程就从运行态转换为阻塞态；当某些条件被满足了，比如sleep结束了，进程的阻塞就会被解除，进程也从阻塞态转换为就绪态
- 退出态：进程被销毁，占用的系统资源都被释放，任何状态的进程都可以直接转换为退出态

## 进程命令

### 1.查看进程

~~~shell
ps aux
~~~

- a：查看所有终端的信息（进程不关联终端的话，TTY那一栏显示 ？ ）
- u：查看用户相关的信息
- x：显示和终端无关的进程信息

### 2.杀死进程

kill命令可以发送投个信号到对应的进程，进程收到某些信号之后默认的处理动作就是退出进程，如果要给进程发送信号，可以先查看一下Linux给我们提供了哪些标准信号

~~~shell
kill -l
 1) SIGHUP       2) SIGINT       3) SIGQUIT      4) SIGILL       5) SIGTRAP
 6) SIGABRT      7) SIGBUS       8) SIGFPE       9) SIGKILL     10) SIGUSR1
11) SIGSEGV     12) SIGUSR2     13) SIGPIPE     14) SIGALRM     15) SIGTERM
16) SIGSTKFLT   17) SIGCHLD     18) SIGCONT     19) SIGSTOP     20) SIGTSTP
21) SIGTTIN     22) SIGTTOU     23) SIGURG      24) SIGXCPU     25) SIGXFSZ
26) SIGVTALRM   27) SIGPROF     28) SIGWINCH    29) SIGIO       30) SIGPWR
31) SIGSYS      34) SIGRTMIN    35) SIGRTMIN+1  36) SIGRTMIN+2  37) SIGRTMIN+3
38) SIGRTMIN+4  39) SIGRTMIN+5  40) SIGRTMIN+6  41) SIGRTMIN+7  42) SIGRTMIN+8
43) SIGRTMIN+9  44) SIGRTMIN+10 45) SIGRTMIN+11 46) SIGRTMIN+12 47) SIGRTMIN+13
48) SIGRTMIN+14 49) SIGRTMIN+15 50) SIGRTMAX-14 51) SIGRTMAX-13 52) SIGRTMAX-12
53) SIGRTMAX-11 54) SIGRTMAX-10 55) SIGRTMAX-9  56) SIGRTMAX-8  57) SIGRTMAX-7
58) SIGRTMAX-6  59) SIGRTMAX-5  60) SIGRTMAX-4  61) SIGRTMAX-3  62) SIGRTMAX-2
63) SIGRTMAX-1  64) SIGRTMAX
~~~

9号信号SIGKILL的行为是无条件杀死进程，想要杀死那个进程就可以把这个信号发送给这个进程，具体操作如下：

~~~shell
kill -9 [进程ID]
kill -SIGKILL [进程ID]
~~~

